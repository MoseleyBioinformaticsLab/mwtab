
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Metadata Column Matching &#8212; mwtab 0.1.dev1+g842206e48 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=46b6e079" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=576dab3d"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'metadata_column_matching';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The mwtab API Reference" href="api.html" />
    <link rel="prev" title="The mwtab Tutorial" href="tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.1.dev1+g842206e48" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">mwtab 0.1.dev1+g842206e48 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="guide.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="tutorial.html">
    The mwtab Tutorial
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Metadata Column Matching
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="api.html">
    The mwtab API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="license.html">
    License
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="todo.html">
    TODO
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="guide.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="tutorial.html">
    The mwtab Tutorial
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Metadata Column Matching
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="api.html">
    The mwtab API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="license.html">
    License
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="todo.html">
    TODO
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reusing-match-code">Reusing Match Code</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#columnfinder-class">ColumnFinder Class</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regular-expressions">Regular Expressions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#column-finders-dictionary">column_finders Dictionary</a></li>
</ul>
</li>
</ul>
  </nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Metadata Column Matching</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="metadata-column-matching">
<h1>Metadata Column Matching<a class="headerlink" href="#metadata-column-matching" title="Link to this heading">#</a></h1>
<p>The mwTab format gives a lot of freedom to uploaders in what kind of metadata associated
with the assigned metabolites can be given. While this has its merits, a big drawback
is the amount of different names given for the same column of information. For example,
using both ‘m/z’ and ‘moverz’. Another drawback is the variety of value formats for
some columns. For example, a column containing HMDB IDs might leave the ‘HMDB’ prefix
off of the beginning of the ID, or the ‘HMDB’ prefix might be lower case. To address
these issues a significant amount of work was done to data mine the most used and
most useful columns and using this information code was created to be able to identify the columns under
their various names as well as evaluate the format of their values.</p>
<p>This code is utilized in the validation to inform users about the state of their
metadata columns in the METABOLITES section. In order to do this we chose standardized
column names and value formats based on the information obtained during data mining,
so there were some executive decisions we made in deciding what the standard names and
values are or should be. We did our best to base them on the data already in the
Metabolomics Workbench.</p>
<p>We did our best to test this code on the data in the Metabolomics Workbench, but it
is not perfect. Due to the nature of regular expressions and trying to match a variety
of names and values, inevitably there are going to be false positives and negatives.
You may see a validation warning about a column name or value in error. If you do
find incorrect warnings or issues that are not being warned about in the validation,
please visit our GitHub <a class="reference external" href="https://github.com/MoseleyBioinformaticsLab/mwtab/issues">Issues</a> and create a new issue for it.</p>
<section id="reusing-match-code">
<h2>Reusing Match Code<a class="headerlink" href="#reusing-match-code" title="Link to this heading">#</a></h2>
<p>Although the mwtab package is largely meant to be used through its CLI, the code
created for column name and value matching could have many more use cases outside
of this package. This section will explain the different parts of the code and how
they might be used outside of this package.</p>
<p>The 3 significant parts are:
1. ColumnFinder class
2. Regular expressions and associated functions
3. Dictionary of ColumnFinders for specific mwTab columns</p>
<section id="columnfinder-class">
<h3>ColumnFinder Class<a class="headerlink" href="#columnfinder-class" title="Link to this heading">#</a></h3>
<p>Column matching has 2 components, matching column names and matching column values,
therefore, a ColumnFinder has a NameMatcher and ValueMatcher to handle those functions.
All NameMatcher attributes are lists of strings or lists of lists of strings and all
are used in its only method, dict_match. All ValueMatcher attributes are strings and
all are used in its only method, series_match. ColumnFinder takes both a NameMatcher
and ValueMatcher, along with a standard_name attribute. The “standard_name” attribute
is not used by any method and is simply there to tie the instance of the class to a
name. The <a class="reference internal" href="api.html#metadata-column-matching"><span class="std std-ref">Metadata Column Matching</span></a> page for metadata_column_matching.py
contains more detailed information and examples on each class.</p>
</section>
<section id="regular-expressions">
<h3>Regular Expressions<a class="headerlink" href="#regular-expressions" title="Link to this heading">#</a></h3>
<p>In order to create some of the complex regular expressions needed to validate column
names and values, a modular approach to constructing them was taken. This means the
smaller building block regular expressions could have use outside of this particular
one. There is also a function used heavily in creating these regular expressions,
make_list_regex. The <a class="reference internal" href="api.html#metadata-column-matching"><span class="std std-ref">Metadata Column Matching</span></a> page for metadata_column_matching.py
contains more detailed information about using this function. There are too many
regular expressions to explain each one, so the source code for creating them is
included below. The names are largely self explanatory, and being able to see the
regular expression for each name can help clear up confusion.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INTEGER</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;-?\d+&#39;</span>
<span class="n">FLOAT</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;-?\d*\.\d+&#39;</span>
<span class="n">SCIENTIFIC_NOTATION</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;-?\d*\.\d+E(-|\+)?\d+&#39;</span>
<span class="n">NUMS</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">FLOAT</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="n">SCIENTIFIC_NOTATION</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="n">INTEGER</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
<span class="n">NUM_RANGE</span> <span class="o">=</span> <span class="n">NUMS</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;(-|\sto\s|−)&#39;</span> <span class="o">+</span> <span class="n">NUMS</span>
<span class="n">LIST_OF_NUMS</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">NUMS</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">BRACKETED_LIST_OF_NUMS</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\[&#39;</span> <span class="o">+</span> <span class="n">LIST_OF_NUMS</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\]&#39;</span>
<span class="n">PARENTHESIZED_LIST_OF_NUMS</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\(&#39;</span> <span class="o">+</span> <span class="n">LIST_OF_NUMS</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\)&#39;</span>
<span class="n">LIST_OF_NUMS_UNDERSCORE</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">NUMS</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_NUMS_SLASH</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">NUMS</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="n">POSITIVE_NUMS</span> <span class="o">=</span> <span class="n">NUMS</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">POSITIVE_INTS</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\d+&#39;</span>
<span class="n">LIST_OF_POS_INTS</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">POSITIVE_INTS</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_POS_INTS_OR</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">POSITIVE_INTS</span><span class="p">,</span> <span class="s1">&#39;or&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_POS_INTS_BAR</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">POSITIVE_INTS</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\|&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_POS_INTS_SLASH</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">POSITIVE_INTS</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_POS_INTS_SEMICOLON</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">POSITIVE_INTS</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_POS_INTS_SPACE</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">POSITIVE_INTS</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>

<span class="n">POSITIVE_FLOATS</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\d*.\d+&#39;</span>
<span class="n">POSITIVE_SCIENTIFIC_NOTATION</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\d*\.\d*E(-|\+)?\d+&#39;</span>
<span class="n">POSITIVE_FLOAT_RANGE</span> <span class="o">=</span> <span class="n">POSITIVE_FLOATS</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\s*(_|-)\s*&#39;</span> <span class="o">+</span> <span class="n">POSITIVE_FLOATS</span>
<span class="n">LIST_OF_POS_FLOATS_UNDERSCORE</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">POSITIVE_FLOATS</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
<span class="n">POS_FLOAT_PAIRS</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span>  <span class="n">POSITIVE_FLOATS</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;(_|@)&#39;</span> <span class="o">+</span> <span class="n">POSITIVE_FLOATS</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
<span class="n">LIST_OF_POS_FLOAT_PAIRS_UNDERSCORE</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">POS_FLOAT_PAIRS</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_POS_FLOAT_PAIRS_NO_SPACE</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">POS_FLOAT_PAIRS</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_POS_FLOAT_PAIRS_MIXED</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">POS_FLOAT_PAIRS</span><span class="p">,</span> <span class="s1">&#39;(//|,)&#39;</span><span class="p">)</span>
<span class="n">POS_INT_FLOAT_PAIR</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span>  <span class="n">POSITIVE_INTS</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;_&#39;</span> <span class="o">+</span> <span class="n">POSITIVE_FLOATS</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>

<span class="n">ELEMENT_SYMBOL</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;([BCFHIKNOPSUVWY]|[ISZ][nr]|[ACELP][ru]|A[cglmst]|B[aehikr]|&#39;</span>
                  <span class="sa">r</span><span class="s1">&#39;C[adeflos]|D[bsy]|Es|F[elmr]|G[ade]|H[efgos]|Kr|L[aiv]|M[cdgnot]|&#39;</span>
                  <span class="sa">r</span><span class="s1">&#39;N[abdehiop]|O[gs]|P[abdmot]|R[abe-hnu]|S[bcegim]|T[abcehilms]|Xe|Yb)&#39;</span><span class="p">)</span>
<span class="n">ELEMENT_COUNT</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;([1-9]\d*)*&#39;</span>
<span class="n">FORMULA_ELEMENT</span> <span class="o">=</span> <span class="n">ELEMENT_SYMBOL</span> <span class="o">+</span> <span class="n">ELEMENT_COUNT</span>
<span class="n">FORMULA</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">FORMULA_ELEMENT</span> <span class="o">+</span> <span class="s1">&#39;)+&#39;</span>
<span class="n">LIST_OF_FORMULAS</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">FORMULA</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">BRACKETED_LIST_OF_FORMULAS</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\[&#39;</span> <span class="o">+</span> <span class="n">LIST_OF_FORMULAS</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\]&#39;</span>
<span class="c1"># C12H22O11, C12 H22 O11, [13C]4H7NO4, [13]C6 H14 [15]N4 O2, [C13]C4H6O5, C21C(13)2H38N7O17P3S, 12C12+14N4+16O19+1H32</span>
<span class="n">ISOTOPIC_NUM</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\d+&#39;</span>
<span class="c1"># Add dueterium.</span>
<span class="n">ISOTOPIC_SYMBOL</span> <span class="o">=</span> <span class="n">ELEMENT_SYMBOL</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;|D)&#39;</span>
<span class="n">ISOTOPIC_ELEMENT</span> <span class="o">=</span> <span class="n">ISOTOPIC_SYMBOL</span> <span class="o">+</span> <span class="n">ELEMENT_COUNT</span>
<span class="n">ISOTOPIC_FORMULA</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">ISOTOPIC_ELEMENT</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> \
                   <span class="sa">r</span><span class="s1">&#39;\[&#39;</span> <span class="o">+</span> <span class="n">ISOTOPIC_NUM</span> <span class="o">+</span> <span class="n">ISOTOPIC_SYMBOL</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\]&#39;</span> <span class="o">+</span> <span class="n">ELEMENT_COUNT</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> \
                   <span class="sa">r</span><span class="s1">&#39;\[&#39;</span> <span class="o">+</span> <span class="n">ISOTOPIC_NUM</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\]&#39;</span> <span class="o">+</span> <span class="n">ISOTOPIC_ELEMENT</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> \
                   <span class="sa">r</span><span class="s1">&#39;\[&#39;</span> <span class="o">+</span> <span class="n">ISOTOPIC_SYMBOL</span> <span class="o">+</span> <span class="n">ISOTOPIC_NUM</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\]&#39;</span> <span class="o">+</span> <span class="n">ELEMENT_COUNT</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> \
                   <span class="n">ISOTOPIC_SYMBOL</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\(&#39;</span> <span class="o">+</span> <span class="n">ISOTOPIC_NUM</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\)&#39;</span> <span class="o">+</span> <span class="n">ELEMENT_COUNT</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> \
                   <span class="n">make_list_regex</span><span class="p">(</span><span class="n">ISOTOPIC_NUM</span> <span class="o">+</span> <span class="n">ISOTOPIC_SYMBOL</span> <span class="o">+</span> <span class="n">ELEMENT_COUNT</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\+&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)+&#39;</span>
<span class="n">LIST_OF_ISOTOPIC_FORMULAS</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">ISOTOPIC_FORMULA</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">BRACKETED_LIST_OF_ISOTOPIC_FORMULAS</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\[&#39;</span> <span class="o">+</span> <span class="n">LIST_OF_ISOTOPIC_FORMULAS</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\]&#39;</span>
<span class="c1"># C12H22O11+, [C12H22O11]+</span>
<span class="n">CHARGE_FORMULA</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;(\[&#39;</span> <span class="o">+</span> <span class="n">FORMULA</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\](-|\+)&#39;</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="n">FORMULA</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;(-|\+)&#39;</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
<span class="c1"># CH3(CH2)16COOH</span>
<span class="n">GROUP_FORMULA</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">FORMULA_ELEMENT</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\(&#39;</span> <span class="o">+</span> <span class="n">FORMULA</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\)\d+&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)+&#39;</span>

<span class="n">ORGANIC_ELEMENT_SYMBOL</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;([CHNOPS])&#39;</span>
<span class="n">ORGANIC_FORMULA_ELEMENT</span> <span class="o">=</span> <span class="n">ORGANIC_ELEMENT_SYMBOL</span> <span class="o">+</span> <span class="n">ELEMENT_COUNT</span>
<span class="n">ORGANIC_FORMULA</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">ORGANIC_FORMULA_ELEMENT</span> <span class="o">+</span> <span class="s1">&#39;){4,}&#39;</span>

<span class="n">SMILES_ELEMENT_SYMBOL</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\d?[a-zA-Z][a-z]?&#39;</span>
<span class="c1"># Note the , , , and  symbols at the end of the character set are &#39;\x01&#39;, &#39;x02&#39;, &#39;\x03&#39;, and &#39;\x04&#39;. </span>
<span class="c1"># I don&#39;t think they are apart of the SMILES characters, but they appeared in the SMILES of some datasets.</span>
<span class="c1"># There are some SMILES in AN003143 like &#39;C[n]1c[n]cc1C[C@@H](NC(=O)CCN)C(O)=O |&amp;1:7|&#39;. </span>
<span class="c1"># I don&#39;t think the end bit between &#39;|&#39; is part of a legit SMILES, but I added it to pass this dataset.</span>
<span class="n">SMILES</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;(\[?&#39;</span> <span class="o">+</span> <span class="n">SMILES_ELEMENT_SYMBOL</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;[0-9@+\-[\]()</span><span class="se">\\</span><span class="s1">/%=#$.*]*)+&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;( \|[0-9:&amp;,w]+\|)?&#39;</span>
<span class="n">LIST_OF_SMILES_SEMICOLON</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">SMILES</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>

<span class="n">INCHIKEY</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;(InChIKey=)?[a-zA-Z]</span><span class="si">{14}</span><span class="s1">-[a-zA-Z]</span><span class="si">{10}</span><span class="s1">-[a-zA-Z]?&#39;</span>
<span class="n">INCHIKEY_OR_NULL</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHIKEY</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;|null|No record)&#39;</span>
<span class="n">LIST_OF_INCHIKEYS</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHIKEY</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\s*,\s*)+&#39;</span> <span class="o">+</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHIKEY</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\s*|\s*)&#39;</span>
<span class="n">LIST_OF_INCHIKEYS_SLASH</span> <span class="o">=</span> <span class="n">LIST_OF_INCHIKEYS</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>

<span class="c1"># InChI=1 or InChI=1 where &quot;1&quot; is a version number and &quot;S&quot; means it&#39;s a standard InChI.</span>
<span class="n">INCHI_HEAD</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;InChI=&#39;</span>
<span class="n">INCHI_VERSION</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\d+S?&#39;</span>
<span class="n">INCHI_FORMULA</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">FORMULA</span>
<span class="n">INCHI_SKELETAL_LAYER</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/c(\d+([-,()])?)+&#39;</span>
<span class="n">INCHI_HYDROGEN_LAYER</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/h&#39;</span> <span class="o">+</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+(-\d+)?H?\d*&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;(\(H\d*-?(,\d+)+\))*&#39;</span>
<span class="n">INCHI_CHARGE_LAYER</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/q(-|\+)\d+&#39;</span>
<span class="n">INCHI_PROTONATION_LAYER</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/p(-|\+)\d+&#39;</span>
<span class="n">INCHI_STEREOCHEMISTRY_LAYER</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/t&#39;</span> <span class="o">+</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(\d+(-|\+|\?|u)|M)&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">INCHI_STEREOCHEMISTRY_SUBLAYER1</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/m\d+&#39;</span>
<span class="n">INCHI_STEREOCHEMISTRY_SUBLAYER2</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/s\d+&#39;</span>
<span class="n">INCHI_FIXED_HYDROGEN_LAYER</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/f(&#39;</span> <span class="o">+</span> <span class="n">FORMULA</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span> <span class="o">+</span> \
                             <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHI_HYDROGEN_LAYER</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span> <span class="o">+</span> \
                             <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHI_STEREOCHEMISTRY_SUBLAYER2</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span> <span class="o">+</span> \
                             <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHI_CHARGE_LAYER</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span>
<span class="n">INCHI_DOUBLEBOND_LAYER</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/b&#39;</span> <span class="o">+</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\d+(-|\+)\d+(-|\+)&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">INCHI_ISOTOPIC_LAYER</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/i&#39;</span> <span class="o">+</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(\d+(-|\+)\d+|\d+[A-Z]\d*|\d+(-|\+)\d+[A-Z]?\d*)&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHI_STEREOCHEMISTRY_SUBLAYER2</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span>

<span class="n">FULL_INCHI</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHI_HEAD</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span> <span class="o">+</span> \
             <span class="n">INCHI_VERSION</span> <span class="o">+</span> \
             <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHI_FORMULA</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span> <span class="o">+</span> \
             <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHI_SKELETAL_LAYER</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span> <span class="o">+</span> \
             <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHI_HYDROGEN_LAYER</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span> <span class="o">+</span> \
             <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHI_CHARGE_LAYER</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span> <span class="o">+</span> \
             <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHI_PROTONATION_LAYER</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span> <span class="o">+</span> \
             <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHI_DOUBLEBOND_LAYER</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span> <span class="o">+</span> \
             <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHI_STEREOCHEMISTRY_LAYER</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span> <span class="o">+</span> \
             <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHI_STEREOCHEMISTRY_SUBLAYER1</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span> <span class="o">+</span> \
             <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHI_STEREOCHEMISTRY_SUBLAYER2</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span> <span class="o">+</span> \
             <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHI_ISOTOPIC_LAYER</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span> <span class="o">+</span> \
             <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHI_FIXED_HYDROGEN_LAYER</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span>

<span class="n">CHEAP_INCHI</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\s*&#39;</span> <span class="o">+</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">INCHI_HEAD</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;)?&#39;</span> <span class="o">+</span> <span class="n">INCHI_VERSION</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;((/c|/h|/i|/t|/m|/s|/q|/f|/p|/b|/[A-Z])(\S)+)+&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\s*&#39;</span>
<span class="n">LIST_OF_INCHI</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">CHEAP_INCHI</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">BRACKETED_LIST_OF_INCHI</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\[&#39;</span> <span class="o">+</span> <span class="n">LIST_OF_INCHI</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\]&#39;</span>

<span class="c1"># M+H, [M+H]+, -H(-), M+AGN+H, M+Acid, (M-H)/2, [M+NH4] +_[M+Na]+, [M+H–H2O]+, [M-2H](2-)</span>
<span class="c1"># Cat, Hac, and Chol-head are wierd special cases.</span>
<span class="n">ION_ELEMENTS</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;(\d?(m|M)&#39;</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> \
               <span class="sa">r</span><span class="s1">&#39;(-|\+)?\d*&#39;</span> <span class="o">+</span> <span class="n">FORMULA</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\d*(\((-|\+)\))?&#39;</span> <span class="o">+</span>  <span class="s1">&#39;|&#39;</span> <span class="o">+</span> \
               <span class="sa">r</span><span class="s1">&#39;[ [a-zA-Z]*(A|a)cid&#39;</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> \
               <span class="sa">r</span><span class="s1">&#39;Cat&#39;</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;Chol-head&#39;</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;Hac&#39;</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\di&#39;</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;FA|NA|A&#39;</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
<span class="n">ION</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">ION_ELEMENTS</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;(-|\+)?&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
<span class="n">ION</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">ION</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> \
      <span class="sa">r</span><span class="s1">&#39;\[&#39;</span> <span class="o">+</span> <span class="n">ION</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\]\(?\d?\s?(-|\+)?\d?\)?&#39;</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> \
      <span class="n">ION</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\](-|\+)?&#39;</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> \
      <span class="sa">r</span><span class="s1">&#39;\(&#39;</span> <span class="o">+</span> <span class="n">ION</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\)((/\d)|(-|\+))?&#39;</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
<span class="n">LIST_OF_IONS</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">ION</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_IONS_SPACE</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">ION</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">LIST_OF_IONS_UNDERSCORE</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">ION</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_IONS_MIXED</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">ION</span><span class="p">,</span> <span class="s1">&#39;(_| )&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_IONS_NO_DELIMITER</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">ION</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">BRACKETED_LIST_OF_IONS</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\[&#39;</span> <span class="o">+</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">ION</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;\]&#39;</span>

<span class="c1"># There are values like CA1511 that I can&#39;t confirm are KEGG values. You can&#39;t find them in the compound database, but they appear often.</span>
<span class="c1"># The prefixes CE, UP, Z, and U are the same. There is a common mistake of only having 4 numbers after C, so that is accounted for as well.</span>
<span class="n">KEGG</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;(cpd:)?[CDMGKRZU]0?\d</span><span class="si">{5}</span><span class="s1">\?{0,2}&#39;</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;(DG|ko)\d</span><span class="si">{5}</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;(CA|CE|UP|C)\d</span><span class="si">{4}</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;(NA|n/a)&#39;</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
<span class="n">LIST_OF_KEGG</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">KEGG</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_KEGG_SEMICOLON</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">KEGG</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_KEGG_SLASH</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">KEGG</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_KEGG_SPACE</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">KEGG</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">LIST_OF_KEGG_DOUBLE_SLASH</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">KEGG</span><span class="p">,</span> <span class="s1">&#39;//&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_KEGG_UNDERSCORE</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">KEGG</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_KEGG_HYPHEN</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">KEGG</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_KEGG_MIXED</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">KEGG</span><span class="p">,</span> <span class="s1">&#39;(/|,)&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_KEGG_BAR</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">KEGG</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;(\|)&#39;</span><span class="p">)</span>

<span class="n">HMDB</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;(HMDB|HDMB|YMDB|HMBD)\d+(\*|\?)?&#39;</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;n/a&#39;</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
<span class="n">LIST_OF_HMDB</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">HMDB</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_HMDB_SLASH</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">HMDB</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_HMDB_AMPERSAND</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">HMDB</span><span class="p">,</span> <span class="s1">&#39;&amp;&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_HMDB_SEMICOLON</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">HMDB</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_HMDB_SPACE</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">HMDB</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">LIST_OF_HMDB_UNDERSCORE</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">HMDB</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
<span class="n">HMDB_INT</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\d{,5}&#39;</span>
<span class="n">LIST_OF_HMDB_INTS</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">HMDB_INT</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_HMDB_INTS_SLASH</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">HMDB_INT</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>

<span class="n">LIPID_MAPS</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;LM(PK|ST|GL|FA|SP|GP|PR|SL)[0-9A-Z]{8,10}\*?&#39;</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;(ST|FA|PR|GP|PK|GL|SP)\d{4,6}-&#39;</span> <span class="o">+</span> <span class="n">FORMULA</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
<span class="n">LIST_OF_LMP</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">LIPID_MAPS</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_LMP_UNDERSCORE</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">LIPID_MAPS</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_LMP_SLASH</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">LIPID_MAPS</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>

<span class="c1"># When using Excel, a CAS number can get mistaken for a date and it will automatically change the value.</span>
<span class="n">DATE</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;\d{1,2}/\d{1,2}/(\d</span><span class="si">{4}</span><span class="s1">|\d</span><span class="si">{2}</span><span class="s1">)&#39;</span>
<span class="n">CAS</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;(CAS: ?)?\d+-\d\d-0?\d&#39;</span> <span class="o">+</span> <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="n">DATE</span>
<span class="n">LIST_OF_CAS</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">LIST_OF_CAS_SEMICOLON</span> <span class="o">=</span> <span class="n">make_list_regex</span><span class="p">(</span><span class="n">CAS</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="column-finders-dictionary">
<h3>column_finders Dictionary<a class="headerlink" href="#column-finders-dictionary" title="Link to this heading">#</a></h3>
<p>The column_finders dictionary is the culmination of the ColumnFinder class and
regular expressions for the purpose of finding and evaluating/validating columns
in Metabolomics Workbench datasets. The keys are standardized column names, and the
values are a ColumnFinder class to find and validate that column. The entire library
of datasets in the Metbolomics Workbench was used to determine the most relevant and
most abundant columns that should go into the column_finders dictionary. The column_finders
dictionary is likely to be useful for other similar metabolomics data, but may vary
outside of that usecase. Some columns, such as database ID columns, like PubChem or
KEGG, are likely to be more widely useable, but any user would have to test and
make that determination for themselves. The list of standardized column names available
in the dictionary is given below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="s2">&quot;moverz_quant&quot;</span><span class="p">,</span>
  <span class="s2">&quot;mass&quot;</span><span class="p">,</span>
  <span class="s2">&quot;parent_moverz_quant&quot;</span><span class="p">,</span>
  <span class="s2">&quot;mass_spectrum&quot;</span><span class="p">,</span>
  <span class="s2">&quot;composite_mass_spectrum&quot;</span><span class="p">,</span>
  <span class="s2">&quot;inchi_key&quot;</span><span class="p">,</span>
  <span class="s2">&quot;inchi&quot;</span><span class="p">,</span>
  <span class="s2">&quot;smiles&quot;</span><span class="p">,</span>
  <span class="s2">&quot;formula&quot;</span><span class="p">,</span>
  <span class="s2">&quot;compound&quot;</span><span class="p">,</span>
  <span class="s2">&quot;name&quot;</span><span class="p">,</span>
  <span class="s2">&quot;refmet&quot;</span><span class="p">,</span>
  <span class="s2">&quot;class&quot;</span><span class="p">,</span>
  <span class="s2">&quot;pathway&quot;</span><span class="p">,</span>
  <span class="s2">&quot;pathway_sortorder&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ion&quot;</span><span class="p">,</span>
  <span class="s2">&quot;adduct&quot;</span><span class="p">,</span>
  <span class="s2">&quot;species&quot;</span><span class="p">,</span>
  <span class="s2">&quot;pubchem_id&quot;</span><span class="p">,</span>
  <span class="s2">&quot;kegg_id&quot;</span><span class="p">,</span>
  <span class="s2">&quot;hmdb_id&quot;</span><span class="p">,</span>
  <span class="s2">&quot;lm_id&quot;</span><span class="p">,</span>
  <span class="s2">&quot;chemspider_id&quot;</span><span class="p">,</span>
  <span class="s2">&quot;metlin_id&quot;</span><span class="p">,</span>
  <span class="s2">&quot;cas_number&quot;</span><span class="p">,</span>
  <span class="s2">&quot;binbase_id&quot;</span><span class="p">,</span>
  <span class="s2">&quot;chebi_id&quot;</span><span class="p">,</span>
  <span class="s2">&quot;mw_regno&quot;</span><span class="p">,</span>
  <span class="s2">&quot;mzcloud_id&quot;</span><span class="p">,</span>
  <span class="s2">&quot;identifier&quot;</span><span class="p">,</span>
  <span class="s2">&quot;other_id&quot;</span><span class="p">,</span>
  <span class="s2">&quot;other_id_type&quot;</span><span class="p">,</span>
  <span class="s2">&quot;retention_time&quot;</span><span class="p">,</span>
  <span class="s2">&quot;delta_rt&quot;</span><span class="p">,</span>
  <span class="s2">&quot;retention_index&quot;</span><span class="p">,</span>
  <span class="s2">&quot;retention_index_type&quot;</span><span class="p">,</span>
  <span class="s2">&quot;abbreviation&quot;</span><span class="p">,</span>
  <span class="s2">&quot;assignment_certainty&quot;</span><span class="p">,</span>
  <span class="s2">&quot;comment&quot;</span><span class="p">,</span>
  <span class="s2">&quot;assignment_method&quot;</span><span class="p">,</span>
  <span class="s2">&quot;isotopologue&quot;</span><span class="p">,</span>
  <span class="s2">&quot;isotopologue_type&quot;</span><span class="p">,</span>
  <span class="s2">&quot;peak_description&quot;</span><span class="p">,</span>
  <span class="s2">&quot;peak_pattern&quot;</span><span class="p">,</span>
  <span class="s2">&quot;transient_peak&quot;</span><span class="p">,</span>
  <span class="s2">&quot;transient_peak_type&quot;</span><span class="p">,</span>
  <span class="s2">&quot;fish_coverage&quot;</span><span class="p">,</span>
  <span class="s2">&quot;msi_category&quot;</span><span class="p">,</span>
  <span class="s2">&quot;annotations&quot;</span><span class="p">,</span>
  <span class="s2">&quot;istd&quot;</span><span class="p">,</span>
  <span class="s2">&quot;platform&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ms_method&quot;</span><span class="p">,</span>
  <span class="s2">&quot;polarity&quot;</span><span class="p">,</span>
  <span class="s2">&quot;esi_mode&quot;</span><span class="p">,</span>
  <span class="s2">&quot;ionization_mode&quot;</span><span class="p">,</span>
  <span class="s2">&quot;frequency&quot;</span>
<span class="p">]</span>
</pre></div>
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The mwtab Tutorial</p>
      </div>
    </a>
    <a class="right-next"
       href="api.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">The mwtab API Reference</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2020, Christian D. Powell, Andrey Smelter, Hunter N.B. Moseley.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>